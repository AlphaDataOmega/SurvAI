# 📚 SurvAI Documentation

Welcome to the SurvAI documentation hub. This directory contains comprehensive guides, API references, and implementation details for all SurvAI features.

## 📋 Documentation Index

### 🎯 Getting Started
- **📖 [Main README](../README.md)** - Project overview, setup, and quick start guide  
  *Updated: Jul 9, 2025 • 25 min read*
- **🚀 [Deployment Guide](DEPLOYMENT.md)** - Complete deployment guide with bootstrap script and Docker setup  
  *Updated: Jul 9, 2025 • 15 min read*
- **📋 [Features Overview](FEATURES_OVERVIEW.md)** - Comprehensive overview of all SurvAI features  
  *Updated: Jul 9, 2025 • 8 min read*
- **🚀 [Installation Guide](../README.md#-quick-start)** - Step-by-step installation and setup  
  *Updated: Jul 9, 2025 • 5 min read*

### 🤖 AI Integration
- **🤖 [AI Integration Service](AI_INTEGRATION_SERVICE.md)** - Multi-provider AI service with OpenAI and Ollama fallback  
  *Updated: Jul 8, 2025 • 7 min read*
- **🚀 [AI Deployment Guide](AI_DEPLOYMENT_GUIDE.md)** - Production deployment and scaling guide for AI services  
  *Updated: Jul 8, 2025 • 8 min read*
- **⚡ [Question Controller + AI Integration](QUESTION_CONTROLLER_AI_INTEGRATION.md)** - AI-powered question management and generation  
  *Updated: Jul 8, 2025 • 8 min read*
- **📊 [Dynamic Question Engine](DYNAMIC_QUESTION_ENGINE_DEPLOYMENT.md)** - Dynamic question generation system architecture  
  *Updated: Jul 7, 2025 • 6 min read*

### 💰 Revenue Optimization
- **📈 [EPC Comprehensive Guide](EPC_COMPREHENSIVE_GUIDE.md)** - Complete EPC service documentation including architecture and API reference  
  *Updated: Jul 9, 2025 • 20 min read*
- **🔄 [EPC-Driven Question Ordering](EPC_DRIVEN_QUESTION_ORDERING.md)** - Performance-based question optimization system  
  *Updated: Jul 9, 2025 • 7 min read*

### 🛠️ Admin Management
- **📊 [Dashboard API Reference](DASHBOARD_API_REFERENCE.md)** - Admin dashboard metrics, analytics, and visualization APIs  
  *Updated: Jul 8, 2025 • 15 min read*
- **💼 [Offer Management API Reference](OFFER_MANAGEMENT_API_REFERENCE.md)** - Complete offer management CRUD operations and analytics  
  *Updated: Jul 8, 2025 • 30 min read*
- **💬 [Admin Chat Interface](ADMIN_CHAT_INTERFACE.md)** - Conversational admin panel with slash commands and modal integration  
  *Updated: Jul 8, 2025 • 10 min read*

### 🔗 Widget Integration
- **🔗 [Widget Integration Guide](WIDGET.md)** - Embeddable widget with enhanced theming and partner attribution  
  *Updated: Jul 9, 2025 • 18 min read*
- **🔗 [Widget API Reference](WIDGET_API_REFERENCE.md)** - Complete API documentation for widget endpoints and session management  
  *Updated: Jul 9, 2025 • 8 min read*
- **🔄 [Widget Resilience Guide](WIDGET_RESILIENCE.md)** - Intelligent batching, offline persistence, and network resilience  
  *Updated: Jul 9, 2025 • 7 min read*
- **🚀 [Widget Production Deployment](WIDGET_PRODUCTION_DEPLOYMENT.md)** - Complete production deployment pipeline with CDN integration  
  *Updated: Jul 9, 2025 • 7 min read*
- **🧪 [Widget Test Page](../examples/widget-test.html)** - Interactive testing and examples for widget integration  
  *Updated: Jul 9, 2025 • Interactive*
- **🎨 [Widget Theme Demo](../examples/widget-theme-test.html)** - Interactive theme customization with live preview  
  *Updated: Jul 9, 2025 • Interactive*
- **🔄 [Widget Remote Config Demo](../examples/widget-remote-config.html)** - Remote configuration examples and testing  
  *Updated: Jul 9, 2025 • Interactive*

### 📊 API Documentation
- **📊 [API Dynamic Questions](API_DYNAMIC_QUESTIONS.md)** - Dynamic question generation API with AI integration  
  *Updated: Jul 8, 2025 • 12 min read*
- **📋 [Complete API Reference](../README.md#-api-documentation)** - All API endpoints and examples with authentication  
  *Updated: Jul 9, 2025 • 15 min read*
- **🔐 [Authentication Flow](#authentication-flow)** - AuthProvider setup, route protection, and testing patterns  
  *Updated: Jul 10, 2025 • 8 min read*

### 🧪 Testing & Quality
- **🎯 [Visual Testing Guide](VISUAL_TESTING.md)** - Comprehensive visual regression testing with Playwright  
  *Updated: Jul 9, 2025 • 12 min read*
- **🧪 [Testing Overview](../README.md#-testing)** - Unit, integration, and visual testing strategies  
  *Updated: Jul 9, 2025 • 10 min read*

### 🔧 Development
- **🔄 [Zod Validation Migration](ZOD_VALIDATION_MIGRATION.md)** - TypeScript-first validation upgrade guide  
  *Updated: Jul 8, 2025 • 9 min read*
- **🏗️ [Project Structure](../README.md#-project-structure)** - Codebase organization and architecture patterns  
  *Updated: Jul 9, 2025 • 8 min read*

## 🎯 Quick Navigation

### For Developers
1. **Start Here**: [Main README](../README.md) → [Features Overview](FEATURES_OVERVIEW.md)
2. **API Integration**: [EPC Comprehensive Guide](EPC_COMPREHENSIVE_GUIDE.md) → [Dashboard API Reference](DASHBOARD_API_REFERENCE.md)
3. **AI Features**: [AI Integration Service](AI_INTEGRATION_SERVICE.md) → [AI Deployment Guide](AI_DEPLOYMENT_GUIDE.md)
4. **Testing**: [Visual Testing Guide](VISUAL_TESTING.md) → [Testing Overview](../README.md#-testing)

### For Partners
1. **Widget Integration**: [Widget Integration Guide](WIDGET.md) → [Widget API Reference](WIDGET_API_REFERENCE.md)
2. **Network Resilience**: [Widget Resilience Guide](WIDGET_RESILIENCE.md) → [Offline Batching](WIDGET.md#offline-batching--network-resilience)
3. **Production Deployment**: [Widget Production Deployment](WIDGET_PRODUCTION_DEPLOYMENT.md) → [CDN Integration](WIDGET_PRODUCTION_DEPLOYMENT.md#cdn-structure)
4. **Testing**: [Widget Test Page](../examples/widget-test.html)
5. **Support**: [Troubleshooting](WIDGET.md#troubleshooting)

### For Admins
1. **Dashboard**: [Dashboard API Reference](DASHBOARD_API_REFERENCE.md)
2. **Offer Management**: [Offer Management API Reference](OFFER_MANAGEMENT_API_REFERENCE.md)
3. **Chat Interface**: [Admin Chat Interface](ADMIN_CHAT_INTERFACE.md)

## 📖 Documentation Standards

### Format
- **Markdown**: All documentation uses GitHub-flavored Markdown
- **Code Examples**: Syntax highlighting for all code blocks
- **API References**: Consistent request/response format
- **Screenshots**: Visual examples where helpful

### Structure
- **Overview**: Clear introduction and purpose
- **Quick Start**: Fast setup instructions
- **Detailed Guide**: Comprehensive implementation details
- **Examples**: Real-world usage scenarios
- **Troubleshooting**: Common issues and solutions

### Maintenance
- **Version Control**: Documentation versioned with code
- **Updates**: Regular updates with new features
- **Validation**: Examples tested and verified
- **Feedback**: Community feedback incorporated

## 🔄 Recent Updates

### M4 Phase 04 - Production Widget Pipeline
- **✅ [Widget Production Deployment](WIDGET_PRODUCTION_DEPLOYMENT.md)** - Complete production deployment pipeline documentation
- **✅ [GitHub Actions Workflow](../.github/workflows/widget-deploy.yml)** - Complete CI/CD pipeline for widget releases
- **✅ [Bundle Size Validation](WIDGET_PRODUCTION_DEPLOYMENT.md#bundle-validation)** - Automated size validation and optimization
- **✅ [Widget Integration Guide](WIDGET.md)** - Updated with production CDN URLs and security features

### M4 Phase 03 - Widget Resilience & Batching
- **✅ [Widget Resilience Guide](WIDGET_RESILIENCE.md)** - Intelligent batching and offline persistence
- **✅ [Widget Integration Guide](WIDGET.md)** - Updated with batching and resilience features
- **✅ [Widget API Reference](WIDGET_API_REFERENCE.md)** - New batch endpoint for improved efficiency

### M4 Phase 01 - Embeddable Widget
- **✅ [Widget Integration Guide](WIDGET.md)** - Complete widget documentation
- **✅ [Widget API Reference](WIDGET_API_REFERENCE.md)** - New API endpoints for widget
- **✅ [Features Overview](FEATURES_OVERVIEW.md)** - Updated feature list

### M3 Phase 09 - Visual Testing
- **✅ [Visual Testing Guide](VISUAL_TESTING.md)** - Comprehensive visual regression testing
- **✅ Testing Examples** - Real-world testing scenarios

### M3 Phase 08 - Admin Features
- **✅ [Admin Chat Interface](ADMIN_CHAT_INTERFACE.md)** - Conversational admin panel
- **✅ [Offer Management API Reference](OFFER_MANAGEMENT_API_REFERENCE.md)** - Complete CRUD operations

### M3 Phase 07 - Dashboard & Analytics
- **✅ [Dashboard API Reference](DASHBOARD_API_REFERENCE.md)** - Real-time metrics and visualization
- **✅ Analytics Examples** - Interactive charts and data visualization

## 🔍 Search & Navigation Tips

### Finding Documentation
- **By Category**: Use the organized sections above to find related documentation
- **By Feature**: Search for specific features using your browser's find function (Ctrl+F)
- **By Topic**: Use the quick navigation guides for developers, partners, and admins
- **By Date**: Check "Updated" timestamps to find the most recent documentation

### Documentation Reading Order
1. **New Users**: Start with [Features Overview](FEATURES_OVERVIEW.md) → [Main README](../README.md)
2. **Developers**: [EPC Comprehensive Guide](EPC_COMPREHENSIVE_GUIDE.md) → [API Documentation](API_DYNAMIC_QUESTIONS.md)
3. **Partners**: [Widget Integration Guide](WIDGET.md) → [Widget API Reference](WIDGET_API_REFERENCE.md)
4. **Admins**: [Dashboard API Reference](DASHBOARD_API_REFERENCE.md) → [Admin Chat Interface](ADMIN_CHAT_INTERFACE.md)

### Estimated Reading Times
- **Quick Reference**: 5-10 min read documents for specific API endpoints
- **Comprehensive Guides**: 15-30 min read for complete feature coverage
- **Interactive Examples**: Hands-on testing and experimentation

### Cross-References
- Many documents link to related sections - follow these for complete understanding
- Architecture diagrams and code examples appear in multiple documents
- API references are cross-linked with implementation guides

## 🔐 Authentication Flow

### Overview
SurvAI implements a comprehensive authentication system using React Context API with JWT-based authentication. The system provides role-based access control with admin privileges for protected routes.

### Provider Setup
The authentication system requires proper provider hierarchy in your React application:

```typescript
// Correct provider order in main.tsx
<QueryClientProvider client={queryClient}>
  <AuthProvider>
    <BrowserRouter>
      <App />
    </BrowserRouter>
  </AuthProvider>
</QueryClientProvider>
```

**Critical**: Provider order matters! QueryClient must be outermost for API calls, AuthProvider needs Router for navigation redirects.

### Route Protection
Protected routes use the `RequireAuth` component wrapper:

```typescript
// Admin route protection in App.tsx
<Route 
  path="/admin" 
  element={
    <RequireAuth requireAdmin={true}>
      <AdminPage />
    </RequireAuth>
  } 
/>
```

### Authentication States
- **Loading**: Shows loading spinner while checking authentication
- **Authenticated**: User is logged in, renders protected content
- **Unauthenticated**: Redirects to `/login` page
- **Unauthorized**: Non-admin users accessing admin routes redirect to `/login`

### useAuth Hook
Components can access authentication state using the `useAuth` hook:

```typescript
import { useAuth } from './hooks/useAuth';

const MyComponent = () => {
  const { user, isAuthenticated, isLoading, login, logout } = useAuth();
  
  if (isLoading) return <div>Loading...</div>;
  if (!isAuthenticated) return <div>Please log in</div>;
  
  return <div>Welcome, {user?.name}!</div>;
};
```

### Testing Patterns
Use the provided test wrappers for components that require authentication:

```typescript
import { TestingWrapper } from '../examples/AuthProviderWrapper';

test('component with auth', async () => {
  render(
    <TestingWrapper>
      <MyComponentThatUsesAuth />
    </TestingWrapper>
  );
  
  await waitFor(() => {
    expect(screen.getByText('Dashboard')).toBeInTheDocument();
  });
});
```

### Common Patterns

#### HOC Pattern (Alternative)
```typescript
import { withRequireAuth } from './components/auth/RequireAuth';

const ProtectedComponent = withRequireAuth(MyComponent, true); // requireAdmin = true
```

#### Error Handling
```typescript
// The useAuth hook throws descriptive errors when used incorrectly
export const useAuth = (): AuthContextType => {
  const context = useContext(AuthContext);
  if (!context) {
    throw new Error('useAuth must be used within an AuthProvider');
  }
  return context;
};
```

### Examples Reference
See [AuthProviderWrapper.tsx](../examples/AuthProviderWrapper.tsx) for:
- Production wrapper with proper provider hierarchy
- Testing wrapper for unit tests
- Memory router wrapper for route testing
- Common pitfalls and solutions

### Implementation Files
- **AuthProvider**: `frontend/src/hooks/useAuth.tsx`
- **RequireAuth**: `frontend/src/components/auth/RequireAuth.tsx`
- **Route Setup**: `frontend/src/App.tsx`
- **Provider Chain**: `frontend/src/main.tsx`
- **Test Examples**: `tests/frontend/AdminPage.test.tsx`

### Troubleshooting
1. **"useAuth must be used within an AuthProvider"**: Ensure AuthProvider wraps your component tree
2. **Navigation not working**: Check provider order (AuthProvider must be inside BrowserRouter's parent)
3. **Tests failing**: Use TestingWrapper and mock API calls properly
4. **Infinite redirects**: Check RequireAuth logic and ensure login route exists

## 📞 Support & Contributing

### Getting Help
- **Issues**: Report bugs and request features
- **Discussions**: Community Q&A and discussions
- **Support**: Professional support available

### Contributing
- **Documentation**: Improve existing docs or add new ones
- **Examples**: Share real-world implementation examples
- **Feedback**: Suggest improvements and corrections

### Standards
- **Style Guide**: Follow existing documentation patterns
- **Testing**: Verify all examples work correctly
- **Review**: All contributions reviewed before merge

---

**📚 This documentation is continuously updated to reflect the latest SurvAI features and best practices.**

*For the most current information, always refer to the latest version of the documentation in the repository.*